"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7130],{7130:(x,m,l)=>{l.r(m),l.d(m,{AdminCutsPageModule:()=>T});var h=l(6895),D=l(4719),r=l(7479),p=l(6069),d=l(5861),f=l(4419),e=l(6738),A=l(1549);let u=(()=>{class a{constructor(){this.months=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}getFormatDate(t){return t.setHours(0,0,0,0),{dateObj:t,date:t.getDate(),month:t.getMonth()+1,year:t.getFullYear(),dayOfWeek:t.getDay(),formatDate:`${t.getDate()}/${this.getStringMonth(t.getMonth())}/${t.getFullYear()}`,dbFormatData:`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}}getMonthFormat(t){return`${this.months[t.getMonth()]}/${t.getFullYear()}`}getStringMonth(t){return["Ene","Feb","Mar","Abr","May","Jun","Jul","Agosto","Sept","Oct","Nov","Dic"][t]}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var S=l(529);let Z=(()=>{class a{constructor(t,o,n){this.dbService=t,this.auxFns=o,this.http=n}getSelectedDateSales(t){var o=this;return(0,d.Z)(function*(){const c={action:"getDateSales",params:{tableName:"salidas",conditionObj:{salida_fecha:o.auxFns.getFormatDate(t).dbFormatData}}},g=yield o.http.post(o.dbService.apiURL+"adminCuts",c,{}).toPromise();return!!g&&(console.log(g),g)})()}generateDailyCut(t){}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(A.k),e.LFG(u),e.LFG(S.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),C=(()=>{class a{constructor(t){this.auxFns=t,this.daysOfTheWeek=["Lun","Mar","Mie","Jue","Vie","Sab","Dom"],this.months=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}getActualWeekMondayDate(){const t=new Date;t.setHours(0,0,0,0);let o=t.getDay();if(1===o)return this.auxFns.getFormatDate(t).formatDate;for(;o>1;)0===o&&(o=7),t.setDate(t.getDate()-1),o--;return{formatDate:this.auxFns.getFormatDate(t).formatDate,dateObj:t}}getSelectedWeekDays(t){const o=[],n=t;let i=0;for(;i<=6;)o.push({day:n.getDate(),dateObj:n}),n.setDate(n.getDate()+1),i++;return o}getSelectedMonth(t){let o=[];const n=t.getMonth();t.setHours(0,0,0,0);let i=t;for(;i.getMonth()===n;)i.setDate(i.getDate()-1);for(i.setDate(i.getDate()+1);i.getMonth()===n;)o.push({day:i.getDate(),dateObj:i}),i.setDate(i.getDate()+1);return o}goForwardWeek(t){return t.setDate(t.getDate()+7),this.auxFns.getFormatDate(t)}goBackWeek(t){return t.setDate(t.getDate()-7),this.auxFns.getFormatDate(t)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(u))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();function y(a,s){if(1&a&&(e.TgZ(0,"td",15),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.xp6(1),e.hij(" ",t," ")}}function v(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"ion-button",16),e.NdJ("click",function(){const i=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.openSalesDetails(i))}),e._uU(13," detalles "),e.qZA()()()}if(2&a){const t=s.$implicit;e.xp6(2),e.hij(" ",t.salida_id," "),e.xp6(2),e.hij(" ",t.salida_fecha," "),e.xp6(2),e.hij(" ",t.salida_responsable," "),e.xp6(2),e.hij(" $",t.salida_total," "),e.xp6(2),e.hij(" ",t.salida_tipo," "),e.xp6(2),e.Q6J("color","Venta"===t.salida_tipo?"primary":"warning")}}function _(a,s){if(1&a&&(e.TgZ(0,"ion-row")(1,"ion-col",17)(2,"ion-text")(3,"h6"),e._uU(4),e.qZA()(),e.TgZ(5,"ion-text")(6,"h6"),e._uU(7),e.qZA()(),e.TgZ(8,"ion-text")(9,"h6"),e._uU(10),e.qZA()()()()),2&a){const t=s.$implicit;e.xp6(4),e.Oqu(t.product_name),e.xp6(3),e.Oqu(t.unites),e.xp6(3),e.Oqu(t.subtotal)}}function F(a,s){if(1&a&&(e.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col",13)(3,"ion-text")(4,"h5"),e._uU(5),e.qZA()()(),e.TgZ(6,"ion-col",13)(7,"ion-text")(8,"h5"),e._uU(9),e.qZA()()(),e.TgZ(10,"ion-col",13)(11,"ion-text")(12,"h5"),e._uU(13),e.qZA()()()(),e.YNc(14,_,11,3,"ion-row",7),e.qZA()),2&a){const t=s.$implicit,o=e.oxw();e.xp6(5),e.hij("ID : ",t.salida_id,""),e.xp6(4),e.hij(" Responsable: ",t.salida_responsable," "),e.xp6(4),e.hij(" Total: ",t.salida_total," "),e.xp6(1),e.Q6J("ngForOf",o.getSaleProducts(t.salida_productos))}}const M=[{path:"",component:(()=>{class a{constructor(t,o,n,i,c){this.adminCutsService=t,this.auxFns=o,this.calendarService=n,this.modalController=i,this.loadingController=c,this.selectedCalendarMode="weeklyView",this.tableHeaders=["ID venta","Fecha","Vendedor","Monto","Tipo salida","Detalles"]}ngOnInit(){var t=this;return(0,d.Z)(function*(){const o=yield t.loadingController.create({spinner:"circles",message:"Cargando"});yield o.present(),t.liveWeek=t.calendarService.getActualWeekMondayDate(),t.selectedWeek=t.liveWeek,t.selectedDateSales=yield t.adminCutsService.getSelectedDateSales(new Date),console.log(t.selectedDateSales),yield o.dismiss()})()}getTodaysDate(){const t=new Date;return this.auxFns.getFormatDate(t).formatDate}getSaleProducts(t){return JSON.parse(t)}generateDailyCut(){var t=this;return(0,d.Z)(function*(){t.selectedDateSales.filter(n=>"Venta"===n.salida_tipo),t.getDateSales()})()}getDateSales(){this.selectedDateRealSales=this.selectedDateSales.filter(t=>"Venta"===t.salida_tipo),this.selectedDateSoldProducts=this.selectedDateRealSales.map(t=>JSON.parse(t.salida_productos))}dateChange(t){var o=this;return(0,d.Z)(function*(){t=t.detail.value;const n=yield o.loadingController.create({message:"Cargando",spinner:"bubbles"});yield n.present(),o.selectedDateSales=yield o.adminCutsService.getSelectedDateSales(new Date(t)),n.dismiss(),console.log(o.selectedDateSales)})()}closeSalesDetailsModal(){this.salesDetailsModal.dismiss()}openSalesDetails(t){var o=this;return(0,d.Z)(function*(){return t.salida_productos=JSON.parse(t.salida_productos),o.salesDetailsModal=yield o.modalController.create({component:f.N,componentProps:{closeSalesDetailsModal:o.closeSalesDetailsModal.bind(o),saleData:t}}),yield o.salesDetailsModal.present()})()}getActualWeekMonday(){return this.calendarService.getActualWeekMondayDate()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Z),e.Y36(u),e.Y36(C),e.Y36(r.IN),e.Y36(r.HT))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-admin-cuts"]],decls:40,vars:4,consts:[["slot","start"],["size","8"],[2,"display","flex","flex-direction","row"],["color","danger",2,"flex-basis","50%"],[2,"margin-left","auto",3,"click"],[1,"dataTableContainer"],["class","tableHeaders",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["value","ventas"],["slot","header"],["slot","content"],["value","cortesias"],["value","mermas"],["size","4"],["presentation","date","display-format","DD.MM.YYYY HH:mm",3,"ionChange"],[1,"tableHeaders"],[3,"color","click"],["size","3"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Cortes administrativos"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-grid")(8,"ion-row")(9,"ion-col",1)(10,"ion-text")(11,"h3"),e._uU(12),e.qZA()(),e.TgZ(13,"div",2)(14,"ion-text",3)(15,"h5"),e._uU(16,"Corte pendiente"),e.qZA()(),e.TgZ(17,"ion-button",4),e.NdJ("click",function(){return o.generateDailyCut()}),e._uU(18," Generar corte diario "),e.qZA()(),e.TgZ(19,"ion-content",5)(20,"table")(21,"tr"),e.YNc(22,y,2,1,"td",6),e.qZA(),e.YNc(23,v,14,6,"tr",7),e.qZA()(),e.TgZ(24,"ion-accordion-group")(25,"ion-accordion",8)(26,"ion-item",9),e._uU(27," Ventas "),e.qZA(),e.TgZ(28,"div",10),e.YNc(29,F,15,4,"ion-grid",7),e.qZA()(),e.TgZ(30,"ion-accordion",11)(31,"ion-item",9),e._uU(32," Cortesias "),e.qZA(),e._UZ(33,"ion-item",10),e.qZA(),e.TgZ(34,"ion-accordion",12)(35,"ion-item",9),e._uU(36," Mermas "),e.qZA(),e._UZ(37,"ion-item",10),e.qZA()()(),e.TgZ(38,"ion-col",13)(39,"ion-datetime",14),e.NdJ("ionChange",function(i){return o.dateChange(i)}),e.qZA()()()()()),2&t&&(e.xp6(12),e.hij(" ",o.getTodaysDate()," "),e.xp6(10),e.Q6J("ngForOf",o.tableHeaders),e.xp6(1),e.Q6J("ngForOf",o.selectedDateSales),e.xp6(6),e.Q6J("ngForOf",o.selectedDateRealSales))},dependencies:[h.sg,r.We,r.eh,r.YG,r.Sm,r.wI,r.W2,r.x4,r.jY,r.Gu,r.Ie,r.fG,r.Nd,r.yW,r.wd,r.sr,r.QI]}),a})()}];let b=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[p.Bz.forChild(M),p.Bz]}),a})(),T=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[h.ez,D.u5,r.Pc,b]}),a})()}}]);